#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Sat Apr 27 10:45:37 2019

@author: farismismar
"""

import os
import numpy as np

import matplotlib
import matplotlib.pyplot as plt
import matplotlib.ticker as tick
from matplotlib.ticker import MultipleLocator, FuncFormatter

os.chdir('/Users/farismismar/Desktop/deep')
MAX_EPISODES_DEEP = 8900

def sum_rate(sinr):
    output = []
    for s in sinr:
        s_linear = 10 ** (s / 10.)
        c = np.log2(1 + s_linear)
        output.append(c)

    return output
    

def generate_sum_rate(data1, data2, data3):
    c1 = np.mean(sum_rate(data1))
    c2 = np.mean(sum_rate(data2))
    c3 = np.mean(sum_rate(data3))

    fig = plt.figure(figsize=(8,5))
    
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    X = np.log2(np.array([4,16,64]))
    
    ax = fig.gca()
    
    ax.xaxis.set_major_locator(MultipleLocator(1))
    # Format the ticklabel to be 2 raised to the power of `x`
    ax.xaxis.set_major_formatter(FuncFormatter(lambda x, pos: int(2**x)))


    plot_, = ax.plot(X, [c1, c2, c3], 'ko-')

#    ax.set_xlim(xmin=0.15, xmax=0.55)
    ax.set_xlabel(r'$M_\text{ULA}$')
    ax.set_ylabel(r'$C$ [bps/Hz]')
    ax.set_ylim(4, 12)
    
    plt.grid(True)
    plt.tight_layout()
    plt.savefig('figures/sumrate.pdf', format="pdf")
    plt.show()
    plt.close(fig)    


def generate_ccdf(data1, data2, data3):
    fig = plt.figure(figsize=(8,5))
    
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    for data in [data1, data2, data3]:
        # sort the data:
        data_sorted = np.sort(data)
        
        # calculate the proportional values of samples
        p = 1. * np.arange(len(data)) / (len(data) - 1)
        
        ax = fig.gca()
    
        # plot the sorted data:
        ax.plot(data_sorted, 1 - p)
    

    labels = [r'$M_\text{ULA} = 4$', r'$M_\text{ULA} = 16$', r'$M_\text{ULA} = 64$']
    ax.set_xlabel('$\gamma$')
    ax.set_ylabel('$1 - F_\Gamma(\gamma)$')        
    ax.legend(labels, loc="lower left")
    plt.grid(True)
    plt.tight_layout()
    plt.savefig('figures/ccdf.pdf', format="pdf")
    plt.show()
    plt.close(fig)    

def plot_primary(X,Y, title, xlabel, ylabel, ymax=MAX_EPISODES_DEEP, filename='plot.pdf'):
    fig = plt.figure(figsize=(8,5))
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    #plt.title(title)
    plt.xlabel(xlabel)
    
    ax = fig.gca()
    ax.xaxis.set_major_locator(MultipleLocator(1))
    # Format the ticklabel to be 2 raised to the power of `x`
    ax.xaxis.set_major_formatter(FuncFormatter(lambda x, pos: int(2**x)))
    
    ax.set_autoscaley_on(False)
    
    plot_, = ax.plot(X, Y, 'k^-') #, label='ROC')

#    ax.set_xlim(xmin=0.15, xmax=0.55)
    
    ax.set_ylabel(ylabel)
    ax.set_ylim(0, ymax)
    
    plt.grid(True)
#    plt.legend([plot_], ['ROC'], loc='upper right')
    fig.tight_layout()
    plt.savefig('figures/{}'.format(filename), format='pdf')
    plt.show()

def plot_secondary(X,Y1, Y2, title, xlabel, y1label, y2label, y1max, y2max, filename='plot.pdf'):
    fig = plt.figure(figsize=(8,5))
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    #plt.title(title)
    plt.xlabel(xlabel)
    
    ax = fig.gca()
    ax.xaxis.set_major_locator(MultipleLocator(1))
    # Format the ticklabel to be 2 raised to the power of `x`
    ax.xaxis.set_major_formatter(FuncFormatter(lambda x, pos: int(2**x)))
    
    ax.set_autoscaley_on(False)
    ax_sec = ax.twinx()
    
    plot1_, = ax.plot(X, Y1, 'k^-')
    plot2_, = ax.plot(X, Y2, 'bo-')

#    ax.set_xlim(xmin=0.15, xmax=0.55)
    
    ax.set_ylabel(y1label)
    ax_sec.set_ylabel(y2label)
    
    ax.set_ylim(0, y1max)
    ax_sec.set_ylim(0, y2max)
    
    plt.grid(True)
    plt.legend([plot1_, plot2_], ['TX Power', 'SINR'], loc='upper right')
    fig.tight_layout()
    plt.savefig('figures/{}'.format(filename), format='pdf')
    plt.show()
    
def plot_primary_two(X, Y1, Y2, title, xlabel, ylabel, filename='plot.pdf'):
    fig = plt.figure(figsize=(8,5))
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    #plt.title(title)
    plt.xlabel(xlabel)
    
    ax = fig.gca()
    ax.xaxis.set_major_locator(MultipleLocator(1))
    # Format the ticklabel to be 2 raised to the power of `x`
    ax.xaxis.set_major_formatter(FuncFormatter(lambda x, pos: int(2**x)))
    
    ax.set_autoscaley_on(False)
    
    plot1_, = ax.plot(X, Y1, 'k^-')
    plot2_, = ax.plot(X, Y2, 'bo-')

    ax.set_ylabel(ylabel)
    ax.set_ylim(0, max(max(Y1), max(Y2)))
    
    plt.grid(True)
    plt.legend([plot1_, plot2_], ['User 1', 'User 2'], loc='lower left')
    fig.tight_layout()
    plt.savefig('figures/{}'.format(filename), format='pdf')
    plt.show()
    
    
def plot_primary_three(X1, Y1, X2, Y2, title, xlabel, ylabel, filename='plot.pdf'):
    fig = plt.figure(figsize=(8,5))
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    #plt.title(title)
    plt.xlabel(xlabel)
    
    order = np.argsort(X1)
    X1 = np.array(X1)[order]
    Y1 = np.array(Y1)[order]
    
    order = np.argsort(X2)
    X2 = np.array(X2)[order]
    Y2 = np.array(Y2)[order]
    
    ax = fig.gca()
    
    ax.set_autoscaley_on(False)
    
    plot1_, = ax.plot(X1, Y1, 'k^-')
    plot2_, = ax.plot(X2, Y2, 'bo-')

    ax.set_ylabel(ylabel)
    ax.set_ylim(0, max(max(Y1), max(Y2)))
    
    plt.grid(True)
    plt.legend([plot1_, plot2_], ['User 1', 'User 2'], loc='lower left')
    fig.tight_layout()
    plt.savefig('figures/{}'.format(filename), format='pdf')
    plt.show()
    
def plot_actions(actions, max_timesteps_per_episode, filename='plot.pdf'):
    env_actions = 6
    
    # TODO convert actions
    action_convert = actions
    
    fig = plt.figure(figsize=(8,5))
    plt.rc('text', usetex=True)
    plt.rc('font', family='serif')
    matplotlib.rcParams['text.usetex'] = True
    matplotlib.rcParams['font.size'] = 16
    matplotlib.rcParams['text.latex.preamble'] = [
        r'\usepackage{amsmath}',
        r'\usepackage{amssymb}']
    
    plt.xlabel('Transmit Time Interval (1 ms)')
    plt.ylabel('Action')
    
     # Only integers                                
    ax = fig.gca()
    ax.xaxis.set_major_formatter(tick.FormatStrFormatter('%0g'))
    ax.xaxis.set_ticks(np.arange(0, max_timesteps_per_episode))
    
    ax.set_xlim(xmin=0, xmax=max_timesteps_per_episode - 1)
    
    ax.set_autoscaley_on(False)
    ax.set_ylim(-1, env_actions)
    
    plt.grid(True)
        
    plt.step(np.arange(len(actions)), action_convert_tx, color='b', label='Power Control -- BS 1')
    plt.step(np.arange(len(actions)), action_convert_int, color='b', label='Power Control -- BS 2')
    plt.savefig('figures/{}'.format(filename), format="pdf")
    plt.show(block=True)
    plt.close(fig)
    return

##############################
# 1) Convergence vs Antenna Size

X = np.log2(np.array([4,16,64]))
Y = [987.6,1533,8713]
plot_primary(X,Y, r'\textbf{Convergence vs. Antenna Size}', r'$M$', r'Convergence Episode ($\zeta$)', MAX_EPISODES_DEEP, 'convergence.pdf')

##############################
# 2) Coverage CDF

sinr_progress_4=[28.845667713360115,32.31770259014996,20.136787314933038,12.134543366688,16.32133875952699,36.66529148734349,11.355572176213403,40.401401476990834,4.518121152304303,13.772010685817822,19.785867787578734,2.1961587276919965,45.57265595435152,43.06981784271368,26.6587627170028942,16.581637026610643,13.723947142113591,37.606748516151875,33.04134990700042,39.18284344850136,22.686351610275167,7.961645055134432,41.69734519121921,21.15130800193361,0.1994443934820806,64.28433564008309,57.08125097663288,34.75058060673546,47.20063198656533,47.2358090841562162,15.552394087260957,33.23088967421236,44.04051444921863,25.83142675743359,3.128871281295955,7.609410873047424,26.264449013892936,47.78520675736865,61.890895116923154,45.8247624657252,38.242072522013956,62.12412365739354,51.006255147198026,55.55547042127315,55.621435443721092,52.05150064520314,27.02449660085019,20.24990890975061,8.016567808750487,25.69041344652005,37.01694386813887,18.90794341416512,66.55742103609992,60.46239021878769,21.093611897472474,35.647121064329916,49.05897004465466,6.456197701197487,18.65314080309281,28.6426387580411482,9.859395644966629,11.98361022212641,31.86874272285779,22.3788611389516,10.073245317713187,11.546504124176044,30.068845588895215,1.2406609343675652,26.792164509957104,12.68609606106573,47.47659618154354,0.4332094155563668,17.481879823550088,48.44981269362187,32.194779849463982,16.61504451634523,17.212451577481954,10.049571270023968,34.60435091957761,35.349902747270725,52.44930344864991,33.8070775633059,44.97135007027131,55.06419760917674,60.06783231628965,9.327128780370034,51.92731573699022,27.112110649731676,48.94492180775609,36.843695763381712,58.13562394493789,31.735581762707504,37.27365292200543,25.349210793651164,48.280596932810276,27.30191612899307,28.323149849186006,11.71570973595143,34.53811720533692,58.29505574446536,31.74328242020075,32.0479734197095,28.829182660371387,72.52971598020967,43.6145964513623742,43.61461002362901,50.16304033178527,32.64483550212668,40.15549517375017,51.56649534119082,34.425059708005634,46.20215729450826,19.357255477410828,74.36580186752143,13.691941272289885,66.3936586491863,60.47350186840526,55.34710198291167,60.6783274617476,32.652348741266132,34.70156219835389,17.464595032323004,13.503688595016627,13.578407513005157,42.374202662329466,-0.22700271213946704,61.660187732149026,40.96947521131865,35.996973029075164,55.849583429570345,11.418791396182915,14.683321462147356,29.421128332818146,41.106166352515594,48.7640395579352342,67.87282956529612,57.7973797769798,28.0670589170003,1.987883061869948,15.347371224187453,45.91666124535783,48.02510777349763,37.649721824449834,55.43441415300431,18.557798257573296,2.212043634951771,14.102571685268131,13.228088447630162,39.994151963083816,62.065407811714472,19.72919684804721,26.632570785561136,4.66187516963123,30.22761189793946,61.08941505889958,47.4656560798994,6.806338895939912,30.074512081160183,17.877224261809076,21.343821284614904,6.181936935410802,45.17627236754927,22.90643892275444,23.562105046901564,26.6553799880121932,37.07639712346647,12.191989879078218,1.620236942057238,37.30775792946314,31.792991720036504,-0.8196601319945772,20.900080885236054,18.830062725457186,38.46356618870128,32.40161205663556,39.460592666399364,14.42161638605398,13.185439177957058,47.039016596781366,30.8660732082712072,19.518466853444583,0.37296892250727454,36.237378148617715,28.54043622302347,21.420545851504805,49.81327602574009,54.58337683180321,23.286877230993007,36.74480552008789,24.06646739289666,40.392463818869544,53.96332516278648,31.486336202612737,11.006885649274862,47.723941211879872,37.05503737403796,55.17932814368567,44.45980832161159,15.922586488196659,22.092273176789586,51.441733816729744,48.78696323832693,31.371019386014858,22.62141486744248,43.227790475509636,19.039906938458277,19.085454016993467,44.59190590622708,49.145127325779185,53.7408362448162]
sinr_ue2_progress_4=[23.761244597044143,6.758635414052315,24.878852484075857,35.78896565704741,22.860390551506008,24.16399488062656,45.8120010202747,34.99719614136393,59.95451253520226,39.35782789007257,44.62857851724366,46.9196657226331,35.07444927428268,7.98978174407032,38.169280903327156,46.53483171171872,54.48600298501674,32.52835727265024,60.34598215867739,37.94608624622806,40.542288413009175,23.473571411878883,47.13752250439263,41.376000169571384,28.468651365263746,54.588274109160494,58.12378281415198,50.23112908882044,36.3934356384699,41.08966043678567,31.18190735544145,56.55219677389677,6.42504083776099,46.67419839092535,13.430754075528002,39.23449422419387,73.52589905321432,72.32301564411839,54.06325537039872,16.419331115756542,39.52531464300961,42.337688629700246,22.21631983501335,22.689029071534037,49.24458552020492,15.669947582474702,40.83083826307078,18.979860230111495,-2.228764987261538,54.44471135170404,26.78747416786822,49.34107668839508,42.63030349735432,7.596620961085372,1.1749936412915192,42.3838034645718,25.080690622485783,43.11356676452534,0.7799420020629275,38.68925704657017,48.8116360476095,29.617419027165152,61.655012909162934,33.18893521624663,44.68673621884727,15.014081617515895,68.50967095443424,23.375468258155383,43.97079148344418,40.32014850374647,37.24520670108481,45.03616247003606,31.471812464595764,23.391550692713373,41.38512889088972,32.94579080099996,8.739090092162684,33.663680246374774,13.937687843830489,29.97919476427572,47.01910395378512,25.45212563849897,25.1807789346733,58.6495848118389,34.129328300116896,11.299729371838065,1.9502477823869377,39.426195297025906,23.03344309957587,38.3781282233418,33.77201769923761,-1.9620702533512113,54.280483621308235,13.411920096565735,11.684270703935624,35.796342592970795,36.895070730457846,30.456387561294104,60.55699511874365,42.11923343736381,53.03657960104354,29.79342132036395,27.672077273752787,18.483193966875056,29.836735614668193,33.171388157084294,39.6359989524042,37.231620738279396,19.944665405768312,28.586704851758803,2.1400297147526564,34.39572159299178,64.35270180763953,45.784352104395126,21.285378913297862,51.693005095911964,37.88311474979578,18.222160097222705,6.630893785054381,45.18802297026606,37.39631400510733,14.496602039697887,-2.0759612305684656,9.519185743433916,32.07893311835163,13.456598691108503,26.660417656089578,28.266237847011027,19.834380080730995,23.931312072114817,47.08483329650357,28.229063565771227,30.81231230261252,41.442803465899686,34.77353437438973,9.418295602168612,29.801640509120514,37.21738531928185,-1.485676395219064,33.27969059913231,51.237944751480526,18.842528343893402,29.66002933822292,34.634555320157354,39.905528503732725,0.03368017636499505,59.18405449534792,24.996930970902895,40.79207323966959,30.4350678407387,35.32121627411245,59.27142233707304,31.032354514460216,41.18234889031508,3.475799029819795,48.88155329971901,18.109202315853025,9.96265069828995,28.446548210353157,26.526352622719816,63.1284392111456,-2.1363445477983243,20.604329330618135,61.54340195294488,38.41151107076912,-0.505128965496646,18.674729574437208,47.80143683179081,25.8632100910283,51.09396971921094,14.409818350630507,49.25706766476556,12.90293983039174,67.82253584129441,-2.785765912077639,13.18428018223361,19.18134577584996,33.27427184244226,47.10510765576536,36.377206760263824,27.57283776421154,58.873483984854495,55.35095963006552,58.24374249532067,35.88887969666256,15.572503579624186,41.164911952403436,63.04479282478684,43.99035289361916,40.78697948502354,14.193958033524668,42.83971303794666,18.8634161138568,44.52740217283118,36.37312123167102,19.146337611245418,16.944458841962675,28.298135876630823,31.974746247318876,28.40194443848846,1.5695542812250862,56.43389399067482,52.55498796449851,32.074062435980736,-1.9058876217136458,18.251454669431652,16.038174855867652,17.49938255091793,7.354872394079517,33.21539985815447]

sinr_progress_16=[8.989144593320969,27.720358190675945,35.193185772959,72.86736882528417,20.315660911961913,23.806678532320582,31.040202019035487,65.97519414101502,15.61090060069142,25.072778956352426,34.32302439649249,14.05668826861267,41.56566182086239,49.57470437460317,50.886789028482082,51.795229024457214,62.5010866222317,61.751338842880614,45.10108845995278,51.34897916409179,63.70280018168552,13.753199726991054,19.835309175164287,41.67876760166329,34.410174576789544,40.42138761619886,29.086486210307,34.628398265153734,31.772871847078257,65.950325466727632,33.7379723723982,21.724569339753117,43.83227344384744,36.37122211156654,62.6576121712816,46.8872832780965,54.56029538401235,45.34158430996186,20.31479130196218,60.825286047468936,12.542280255470843,32.85097853559046,52.002519710207224,28.31436214881233,70.095565667442222,56.24248799269346,29.843639768042504,16.17618044415119,33.47339423526502,29.584365527994173,34.26085318976264,2.5240963786487107,53.40230171647177,17.315411280866975,57.23364454993668,30.286806136720497,2.2355641952790526,12.309878715958371,6.5382636501114435,51.5183878612381042,11.490385651055027,24.026562332154672,30.30591629715731,30.95948220357799,35.39610654196971,59.22220776984149,19.278385303673456,52.72212566386891,34.14869929889185,1.9566628829920845,6.890411665688262,18.973736596233476,43.31192172445491,21.002946301012145,36.190226691920282]
sinr_ue2_progress_16=[29.941378955677827,8.328325325079275,27.54455940696677,41.95826008363718,53.20754643403542,35.17505830863157,33.4817847771682,46.32288127212229,4.664100309701748,26.3853005598787,46.2224816286943,17.796467656384213,47.58759579112709,36.7992012739625,43.1366512716271,27.23085950896526,-0.3812489835655336,26.972855527561737,7.626026690189747,3.699465637278388,1.0443160824728555,2.8078773247452355,34.14277331773383,11.680241579082374,50.060816576248406,20.147722688316946,20.218247495912966,18.003480918790064,30.807689679996642,32.61394716297647,62.1360628942086,41.50850060900069,41.12693448098448,43.92731392208568,47.93717932558698,61.02359748323518,42.599619036340826,59.35245926805329,59.40038352111105,44.22101673744919,35.99901073841852,65.79702392429573,79.77616267325566,29.382767058797135,36.51054883469258,37.9459398329953,8.986769644407811,28.556089169334868,36.315375835569235,23.92886477671251,1.6936663801040275,11.307786247081937,58.992267880118035,54.06848881369457,44.663557985667914,19.51303560024472,14.789299284543315,9.164550074246584,0.36275673011616794,43.91240557074255,33.54134719054209,41.735994640649565,29.70206928675185,0.8505358217706158,32.86307368373429,68.52421876613066,28.86403919214859,76.77695204456508,16.392505659684264,43.70338045303676,30.3891362122474,23.596103608847777,32.36029971268384,51.24932849714796,55.17846167057683]

sinr_progress_64=[-0.5967877974863336,5.5748015783422575,0.8549503951473041,61.03697944527448,40.73818592013878,40.50629426993139,11.334341552144668,54.33846107313311,2.8265167146687493,27.331381455202415,47.002505892548115,22.50856318651622,10.403355820555895,5.6910902300970365,55.0854070433014162]
sinr_ue2_progress_64=[9.443571804878383,43.12308917879044,39.70685741840194,46.84543855734419,42.79450344297979,62.46119156133203,36.02112419044846,54.3326775839718,40.50763494038194,61.94005171945861,19.71193672895827,46.782864385447326,74.35498407683787,82.8668834616603,40.45609989066725]

#sinr1_4 = 10*np.log10(np.mean(10**(np.array(sinr_progress_4)/10.)))
#sinr2_4 = 10*np.log10(np.mean(10**(np.array(sinr_ue2_progress_4)/10.)))
#
#sinr1_16 = 10*np.log10(np.mean(10**(np.array(sinr_progress_16)/10.)))
#sinr2_16 = 10*np.log10(np.mean(10**(np.array(sinr_ue2_progress_16)/10.)))
#
#sinr1_64 = 10*np.log10(np.mean(10**(np.array(sinr_progress_64)/10.)))
#sinr2_64 = 10*np.log10(np.mean(10**(np.array(sinr_ue2_progress_64)/10.)))

sinr_4 = sinr_progress_4 + sinr_ue2_progress_4
sinr_16 = sinr_progress_16 + sinr_ue2_progress_16
sinr_64 = sinr_progress_64 + sinr_ue2_progress_64

sinr_4 = np.array(sinr_4)
sinr_16 = np.array(sinr_16)
sinr_64 = np.array(sinr_64)

# cut the CDF at 52 dB SINR (too high)
#sinr_4 = sinr_4[sinr_4 < 52]
#sinr_16 = sinr_16[sinr_16 < 52]
#sinr_64 = sinr_64[sinr_64 < 52]

generate_ccdf(sinr_4, sinr_16, sinr_64)

##############################
# 3) SNR vs. transmit power

tx_power1_progress_4 = [43.930018224093274,43.930018224093274,43.930018224093274,43.930018224093274,43.930018224093274,43.930018224093274,43.930018224093274,44.93001822409327,44.93001822409327,43.930018224093274,43.930018224093274,43.930018224093274,44.93001822409327,43.930018224093274,43.930018224093274,36.96928298729995,37.96928298729995,37.96928298729995,38.96928298729995,38.96928298729995,37.96928298729995,37.96928298729995,37.96928298729995,38.96928298729995,38.96928298729995,38.96928298729995,39.96928298729995,39.96928298729995,39.96928298729995,40.96928298729995,36.46539370664292,37.46539370664293,36.46539370664292,36.46539370664292,37.46539370664293,37.46539370664293,38.46539370664293,38.46539370664293,39.46539370664292,40.46539370664292,40.46539370664292,41.46539370664293,42.46539370664293,43.46539370664292,43.46539370664292,34.51919192207739,35.5191919220774,35.5191919220774,35.5191919220774,35.5191919220774,36.5191919220774,36.5191919220774,37.5191919220774,38.5191919220774,39.51919192207739,40.5191919220774,41.5191919220774,41.5191919220774,42.5191919220774,43.51919192207739,39.230671009956026,39.230671009956026,39.230671009956026,38.230671009956026,38.230671009956026,38.230671009956026,39.230671009956026,40.230671009956026,41.230671009956026,42.230671009956026,43.23067100995602,42.230671009956026,42.230671009956026,41.230671009956026,41.230671009956026,37.22137139252879,37.22137139252879,37.22137139252879,38.22137139252879,38.22137139252879,39.22137139252879,38.22137139252879,38.22137139252879,37.22137139252879,38.22137139252879,38.22137139252879,38.22137139252879,39.22137139252879,39.22137139252879,39.22137139252879,40.920378505456945,40.920378505456945,40.920378505456945,39.92037850545695,39.92037850545695,39.92037850545695,39.92037850545695,39.92037850545695,39.92037850545695,39.92037850545695,40.920378505456945,40.920378505456945,39.92037850545695,39.92037850545695,39.92037850545695,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,36.75787271988542,37.75787271988542,37.75787271988542,34.39460676521564,34.39460676521564,34.39460676521564,34.39460676521564,34.39460676521564,33.39460676521564,33.39460676521564,33.39460676521564,33.39460676521564,33.39460676521564,32.39460676521565,32.39460676521565,33.39460676521564,32.39460676521565,31.39460676521565,35.399700152014056,35.399700152014056,35.399700152014056,35.399700152014056,35.399700152014056,35.399700152014056,35.399700152014056,35.399700152014056,34.399700152014056,34.399700152014056,34.399700152014056,34.399700152014056,34.399700152014056,34.399700152014056,35.399700152014056,39.547523225934725,40.547523225934725,41.547523225934725,41.547523225934725,41.547523225934725,42.547523225934725,42.547523225934725,43.547523225934725,43.547523225934725,43.547523225934725,44.547523225934725,44.547523225934725,44.547523225934725,44.547523225934725,44.547523225934725,35.767941545165264,36.767941545165264,37.767941545165264,38.767941545165264,37.767941545165264,37.767941545165264,38.767941545165264,37.767941545165264,36.767941545165264,36.767941545165264,36.767941545165264,35.767941545165264,35.767941545165264,35.767941545165264,35.767941545165264,35.289732789669685,36.289732789669685,37.289732789669685,38.289732789669685,39.289732789669685,39.289732789669685,39.289732789669685,38.289732789669685,39.289732789669685,39.289732789669685,40.289732789669685,41.289732789669685,42.289732789669685,42.289732789669685,43.289732789669685,37.03517489983104,38.03517489983104,38.03517489983104,38.03517489983104,39.03517489983104,39.03517489983104,40.03517489983104,41.03517489983104,41.03517489983104,42.03517489983105,43.03517489983104,43.03517489983104,44.035174899831034,45.03517489983104,45.03517489983104]
tx_power2_progress_4 = [42.025931881148544,43.02593188114855,42.025931881148544,42.025931881148544,42.025931881148544,42.025931881148544,42.025931881148544,42.025931881148544,42.025931881148544,42.025931881148544,43.02593188114855,44.02593188114855,44.02593188114855,44.02593188114855,44.02593188114855,41.967443045377586,41.967443045377586,41.967443045377586,41.967443045377586,41.967443045377586,41.967443045377586,42.96744304537759,41.967443045377586,41.967443045377586,42.96744304537759,42.96744304537759,42.96744304537759,42.96744304537759,41.967443045377586,41.967443045377586,41.747012138903166,41.747012138903166,41.747012138903166,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,40.74701213890317,42.11108352030435,42.11108352030435,42.11108352030435,42.11108352030435,42.11108352030435,42.11108352030435,43.11108352030434,43.11108352030434,43.11108352030434,43.11108352030434,43.11108352030434,43.11108352030434,43.11108352030434,43.11108352030434,43.11108352030434,37.56826442405376,37.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,38.56826442405376,42.33423612625968,42.33423612625968,41.334236126259675,41.334236126259675,40.334236126259675,40.334236126259675,40.334236126259675,40.334236126259675,40.334236126259675,40.334236126259675,41.334236126259675,42.33423612625968,42.33423612625968,41.334236126259675,41.334236126259675,42.17043712478773,42.17043712478773,42.17043712478773,42.17043712478773,42.17043712478773,43.170437124787725,43.170437124787725,43.170437124787725,43.170437124787725,43.170437124787725,43.170437124787725,43.170437124787725,43.170437124787725,43.170437124787725,44.170437124787725,37.43031488324943,38.43031488324943,39.43031488324943,40.43031488324943,41.43031488324943,42.43031488324944,41.43031488324943,41.43031488324943,41.43031488324943,42.43031488324944,43.43031488324943,44.43031488324942,44.43031488324942,44.43031488324942,44.43031488324942,40.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,39.996021703693415,41.8355804181011,42.83558041810111,42.83558041810111,41.8355804181011,40.83558041810111,39.83558041810111,38.83558041810111,37.83558041810111,37.83558041810111,37.83558041810111,36.8355804181011,37.83558041810111,36.8355804181011,35.8355804181011,35.8355804181011,42.785453656767665,42.785453656767665,42.785453656767665,43.78545365676767,43.78545365676767,43.78545365676767,42.785453656767665,42.785453656767665,42.785453656767665,43.78545365676767,43.78545365676767,43.78545365676767,44.785453656767665,44.785453656767665,45.78545365676767,40.35636918337901,40.35636918337901,40.35636918337901,40.35636918337901,40.35636918337901,39.356369183379016,39.356369183379016,39.356369183379016,39.356369183379016,39.356369183379016,39.356369183379016,39.356369183379016,40.35636918337901,41.356369183379016,42.356369183379016,42.675722478257185,42.675722478257185,42.675722478257185,42.675722478257185,42.675722478257185,42.675722478257185,42.675722478257185,42.675722478257185,42.675722478257185,43.67572247825719,43.67572247825719,43.67572247825719,43.67572247825719,43.67572247825719,43.67572247825719,42.46645932719885,42.46645932719885,42.46645932719885,43.46645932719884,43.46645932719884,43.46645932719884,43.46645932719884,43.46645932719884,42.46645932719885,42.46645932719885,42.46645932719885,42.46645932719885,42.46645932719885,42.46645932719885,42.46645932719885]

tx_power1_progress_16 =[40.46646730042505,41.46646730042506,41.46646730042506,41.46646730042506,41.46646730042506,40.46646730042505,40.46646730042505,40.46646730042505,40.46646730042505,40.46646730042505,39.46646730042506,39.46646730042506,39.46646730042506,39.46646730042506,39.46646730042506,39.14903551273275,39.14903551273275,39.14903551273275,38.149035512732745,38.149035512732745,37.149035512732745,36.149035512732745,35.149035512732745,35.149035512732745,35.149035512732745,35.149035512732745,35.149035512732745,35.149035512732745,35.149035512732745,35.149035512732745,42.76748301102223,42.76748301102223,42.76748301102223,42.76748301102223,42.76748301102223,42.76748301102223,43.76748301102222,43.76748301102222,43.76748301102222,43.76748301102222,43.76748301102222,43.76748301102222,43.76748301102222,43.76748301102222,43.76748301102222,41.71849596542682,41.71849596542682,41.71849596542682,41.71849596542682,41.71849596542682,40.71849596542681,40.71849596542681,41.71849596542682,41.71849596542682,40.71849596542681,41.71849596542682,40.71849596542681,39.71849596542681,40.71849596542681,40.71849596542681,37.68259143560308,36.68259143560307,37.68259143560308,37.68259143560308,38.68259143560307,39.68259143560307,40.68259143560308,41.68259143560307,41.68259143560307,42.68259143560308,43.68259143560308,43.68259143560308,43.68259143560308,43.68259143560308,43.68259143560308]
tx_power2_progress_16 =[37.923496808944016,37.923496808944016,38.923496808944016,38.923496808944016,38.923496808944016,38.923496808944016,38.923496808944016,37.923496808944016,38.923496808944016,37.923496808944016,37.923496808944016,37.923496808944016,36.923496808944016,36.923496808944016,35.923496808944016,40.57855456067686,41.57855456067686,41.57855456067686,41.57855456067686,40.57855456067686,40.57855456067686,40.57855456067686,40.57855456067686,39.57855456067685,39.57855456067685,39.57855456067685,39.57855456067685,39.57855456067685,39.57855456067685,40.57855456067686,36.81297453663835,37.81297453663835,38.81297453663835,39.81297453663835,39.81297453663835,39.81297453663835,39.81297453663835,40.81297453663836,41.81297453663835,41.81297453663835,42.81297453663835,43.81297453663835,44.81297453663835,44.81297453663835,45.81297453663836,43.61803197293276,42.618031972932755,42.618031972932755,42.618031972932755,43.61803197293276,43.61803197293276,43.61803197293276,43.61803197293276,42.618031972932755,42.618031972932755,42.618031972932755,42.618031972932755,42.618031972932755,42.618031972932755,41.618031972932755,41.23437620242882,41.23437620242882,41.23437620242882,41.23437620242882,41.23437620242882,41.23437620242882,41.23437620242882,41.23437620242882,42.23437620242882,42.23437620242882,42.23437620242882,42.23437620242882,42.23437620242882,43.23437620242882,43.23437620242882]

tx_power1_progress_64 = [30.24382730102345,30.24382730102345,31.243827301023444,32.243827301023444,33.243827301023444,34.24382730102345,35.24382730102345,35.24382730102345,36.24382730102345,36.24382730102345,37.24382730102345,37.24382730102345,38.243827301023444,39.24382730102345,40.24382730102345]
tx_power2_progress_64 = [39.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,37.920091636970014,37.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014,38.920091636970014]

tx_power_4 = np.mean(10**(np.array([tx_power1_progress_4,tx_power2_progress_4])/10.)) / 1000.
tx_power_16 = np.mean(10**(np.array([tx_power1_progress_16,tx_power2_progress_16])/10.)) / 1000.
tx_power_64 = np.mean(10**(np.array([tx_power1_progress_64,tx_power2_progress_64])/10.)) / 1000.

sinr_avg_4 = 10*np.log10(10 ** (np.mean(sinr_4)/10.))
sinr_avg_16 = 10*np.log10(10 ** (np.mean(sinr_16)/10.))
sinr_avg_64 = 10*np.log10(10 ** (np.mean(sinr_64)/10.))

Y1 = [tx_power_4, tx_power_16, tx_power_64]
Y2 = [sinr_avg_4, sinr_avg_16, sinr_avg_64]

plot_secondary(X,Y1,Y2, r'\textbf{Average TX Power and SINR vs. Antenna Size}', r'$M$', r'Average Transmit Power [dBm]', r'Average Achievable SINR [dB]', 46, 50, 'achievable_sinr_power.pdf')

##############################
# 4) Average achievable rate (or SNR) vs number of antennas
#plot_primary(X,Y2, r'\textbf{Achievable SINR vs. Antenna Size}', r'$M_\text{ULA}$', r'Average Achievable SNR [dB]', 50, 'achievable_snr.pdf')
plot_primary(X,sum_rate(Y2), r'\textbf{Average Sum-Rate vs. Antenna Size}', r'$M$', r'$C$ [bps/Hz]', 14, 'sumrate.pdf')
##############################

